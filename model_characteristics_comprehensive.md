# 🤖 암호화 알고리즘 탐지: 모델별 상세 특징 분석

---

## 📊 전체 성능 요약

| 모델 | Precision | Recall | F1-Score | 속도 | 신뢰도 | RAG 효과 |
|------|-----------|--------|----------|------|--------|----------|
| **GPT-4o** | 29.41% 🥇 | 19.04% | 23.11% | 5.73s | 0.97 🥇 | +8.33% ✅ |
| **Llama 3 8B** | 22.40% | 25.05% 🥈 | 23.65% | 13.57s 🐌 | 0.84 | -17.54% ❌ |
| **Gemini-1.5** | 27.88% 🥈 | 25.68% 🥇 | 26.73% 🥇 | 4.11s ⚡ | 0.82 | -3.51% |

---

## 1️⃣ GPT-4o: Instruction-Following 최적화

### 🏛️ **아키텍처 특징**
- **OpenAI의 RLHF** (Reinforcement Learning from Human Feedback)로 학습
- **구조화된 프롬프트**와 컨텍스트를 따르도록 설계
- **RAG 컨텍스트를 "지시사항"으로 해석**하고 효과적으로 활용
- Omni 모델: 멀티모달 통합 아키텍처

### 📊 **성능 지표**
- **True Positives**: 190 (정답 탐지)
- **False Positives**: 456 (오탐)
- **False Negatives**: 808 (미탐지)
- **Precision**: 29.41% 🥇 (가장 정확함)
- **Recall**: 19.04% (보수적)
- **F1-Score**: 23.11%
- **평균 응답시간**: 5.73초 (중간)
- **평균 신뢰도**: 0.97 (과도한 자신감)

### 🎯 **알고리즘별 탐지 성능**

#### ✅ **강점 알고리즘** (정확도 순)
1. **IDEA**: 100% (1/1) - 블록 암호
2. **MD5**: 75.0% (3/4) - 구형 해시
3. **PBKDF2**: 66.7% (2/3) - 패스워드 해싱
4. **DH (Diffie-Hellman)**: 65.7% (23/35) 🏆 - 키 교환 프로토콜 탐지 최강
5. **DSA**: 52.2% (48/92) - 디지털 서명
6. **RC4**: 50.0% (2/4) - 스트림 암호
7. **Blowfish**: 50.0% (1/2) - 블록 암호
8. **RSA**: 48.1% (39/81) - 공개키 암호

#### ❌ **약점 알고리즘** (정확도 순)
1. **GCM 모드**: 0% (0/2) - 인증 암호화 모드
2. **CBC 모드**: 0% (0/2) - 블록 암호 모드
3. **CTR 모드**: 0% (0/1) - 카운터 모드
4. **ElGamal**: 0% (0/1) - 공개키 암호
5. **Korean Algorithms**: 16.2% (6/37) 🔴 - SEED, HIGHT, ARIA, LEA
6. **SHA-2**: 16.7% (2/12) 🔴 - 현대 해시 표준
7. **ChaCha20**: 33.3% (1/3) - 현대 스트림 암호
8. **DES/3DES**: 37.5% (3/8) - 레거시 블록 암호

### 🔍 **RAG 사용 효과**
- **With RAG**: 32.89% (75/228)
- **Without RAG**: 24.56% (56/228)
- **RAG Impact**: +8.33% ✅
- **결론**: GPT-4o는 RAG 컨텍스트를 "지시사항"으로 효과적으로 활용

### 🎭 **작업 유형별 성능**
- **Logs/Config**: 44.74% (34/76) 🥇 - 구조화된 텍스트에 강함
- **Assembly/Binary**: 29.59% (58/196)
- **Source Code**: 21.20% (39/184)

### 💡 **주요 특징**
- ✅ **보수적 탐지**: 확실한 것만 탐지 (높은 Precision, 낮은 Recall)
- ✅ **Instruction-following 우수**: 프롬프트 지시를 정확히 따름
- ✅ **RAG 의존도 높음**: 외부 지식을 효과적으로 활용
- ✅ **구조화된 데이터에 강함**: 로그, 설정 파일 분석 우수
- ✅ **과신 경향**: 신뢰도 0.97로 과도한 자신감
- ❌ **낮은 Recall**: 많은 알고리즘을 놓침 (FN 808개)
- ❌ **현대 암호 취약**: SHA-2, 암호화 모드, ChaCha20 등
- ❌ **한국 표준 무지**: 16.2%로 심각한 수준

### 🎯 **권장 사용 사례**
- 정밀도가 중요한 감사 (False Positive 최소화 필요)
- 구조화된 로그/설정 파일 분석
- RAG 기반 지식 베이스 활용 가능한 환경

---

## 2️⃣ Llama 3 8B: 오픈소스 Foundation Model

### 🏛️ **아키텍처 특징**
- **Meta의 오픈소스 모델** (8 billion parameters)
- **일반적인 언어 모델링에 최적화**
- **상용 모델 대비 instruction-following 능력 약함**
- **구조화된 RAG 형식이 오히려 혼란 야기**
- 작은 모델 크기 (8B) → 제한된 지식 용량

### 📊 **성능 지표**
- **True Positives**: 250 (정답 탐지) 🥇 최다
- **False Positives**: 866 (오탐) 🔴 최다
- **False Negatives**: 748 (미탐지)
- **Precision**: 22.40% (가장 낮음)
- **Recall**: 25.05% 🥈 (공격적 탐지)
- **F1-Score**: 23.65%
- **평균 응답시간**: 13.57초 🐌 (가장 느림)
- **평균 신뢰도**: 0.84 (적절한 수준)

### 🎯 **알고리즘별 탐지 성능**

#### ✅ **강점 알고리즘** (정확도 순)
1. **MD5**: 100% (1/1) - 구형 해시
2. **RC4**: 100% (2/2) - 스트림 암호 (소수 샘플)
3. **ChaCha20**: 100% (1/1) - 현대 스트림 암호
4. **DSA**: 60.0% (27/45) 🏆 - 디지털 서명 최강
5. **AES**: 60.0% (6/10) 🏆 - 대칭키 암호 최강
6. **SHA-1**: 50.0% (2/4)
7. **DH**: 50.0% (3/6)
8. **RSA**: 43.0% (49/114)

#### ❌ **약점 알고리즘** (정확도 순)
1. **GCM 모드**: 0% (0/6) 🔴 - 완전 실패
2. **CBC 모드**: 0% (0/2)
3. **CTR 모드**: 0% (0/1)
4. **PBKDF2**: 0% (0/1)
5. **Korean Algorithms**: 18.8% (6/32) 🔴
6. **DES/3DES**: 25.0% (1/4)
7. **ECC**: 33.3% (1/3)
8. **SHA-2**: 40.0% (2/5)

### 🔍 **RAG 사용 효과**
- **With RAG**: 31.14% (71/228)
- **Without RAG**: 48.68% (111/228) 🏆
- **RAG Impact**: -17.54% ❌ 심각한 역효과
- **결론**: RAG가 모델을 혼란시킴 - 독립적 추론 선호

### 🎭 **작업 유형별 성능**
- **Logs/Config**: 53.95% (41/76) 🥇 - 최고 성능
- **Assembly/Binary**: 42.35% (83/196) 🥇 - 바이너리 분석 특화
- **Source Code**: 31.52% (58/184)

### 💡 **주요 특징**
- ✅ **공격적 탐지**: 많은 것을 탐지 시도 (높은 Recall)
- ✅ **바이너리/어셈블리 분석 특화**: 42.35%로 최고
- ✅ **로그 분석 우수**: 53.95%로 1위
- ✅ **DSA, AES 탐지 강함**: 특정 알고리즘에 강점
- ✅ **RAG 없이 더 좋음**: 독립적 추론 능력 우수
- ❌ **가장 느림**: 13.57초 (Gemini의 3.3배)
- ❌ **정밀도 최하위**: FP 866개로 오탐 심각
- ❌ **Instruction-following 약함**: 구조화된 프롬프트 이해 부족
- ❌ **암호화 모드 전혀 못함**: GCM, CBC, CTR 모두 0%
- ❌ **한국 표준 취약**: 18.8%

### 🎯 **권장 사용 사례**
- 바이너리/어셈블리 파일 분석
- 넓은 범위의 초기 스크리닝 (Recall 중시)
- RAG 없는 단독 분석 환경
- 비용 제약이 있는 환경 (오픈소스)

---

## 3️⃣ Gemini-1.5: 멀티모달 균형

### 🏛️ **아키텍처 특징**
- **Google의 멀티모달 모델** (최신 Gemini 1.5)
- **다양한 입력 형식에 대한 균형잡힌 성능**
- **외부 정보를 맹목적으로 따르지 않고 자체 판단과 결합**
- **효율적인 컨텍스트 처리**로 응답 시간 증가 거의 없음
- 멀티모달 사전학습으로 패턴 인식 능력 우수

### 📊 **성능 지표**
- **True Positives**: 235 (정답 탐지)
- **False Positives**: 608 (오탐)
- **False Negatives**: 680 (미탐지)
- **Precision**: 27.88% 🥈
- **Recall**: 25.68% 🥇 (가장 높음)
- **F1-Score**: 26.73% 🥇 (가장 균형잡힘)
- **평균 응답시간**: 4.11초 ⚡ (가장 빠름)
- **평균 신뢰도**: 0.82 (겸손한 자신감)

### 🎯 **알고리즘별 탐지 성능**

#### ✅ **강점 알고리즘** (정확도 순)
1. **IDEA**: 100% (1/1) - 블록 암호
2. **PBKDF2**: 100% (1/1) - 패스워드 해싱
3. **ElGamal**: 100% (1/1) - 공개키 암호
4. **Camellia**: 100% (1/1) - 일본 표준 블록 암호
5. **Twofish**: 100% (1/1) - 블록 암호
6. **ECC (타원곡선)**: 83.3% (5/6) 🏆 - 압도적 1위
7. **MD5**: 71.4% (5/7) - 구형 해시
8. **DH**: 68.8% (22/32) - 키 교환
9. **RC4**: 66.7% (4/6) - 스트림 암호
10. **AES**: 60.0% (9/15) - 현대 표준

#### ❌ **약점 알고리즘** (정확도 순)
1. **bcrypt**: 0% (0/1) - 패스워드 해싱
2. **GCM 모드**: 0% (0/3)
3. **CTR 모드**: 0% (0/1)
4. **SHA-2**: 25.0% (3/12) 🔴 - 현대 해시
5. **Korean Algorithms**: 31.6% (12/38) 🔴 - 가장 높지만 여전히 낮음
6. **ChaCha20**: 33.3% (1/3)
7. **CBC 모드**: 40.0% (2/5)
8. **Blowfish**: 50.0% (1/2)

### 🔍 **RAG 사용 효과**
- **With RAG**: 37.28% (85/228)
- **Without RAG**: 40.79% (93/228)
- **RAG Impact**: -3.51% (약간 역효과)
- **결론**: 자체 판단과 RAG를 균형있게 활용, 맹목적 추종 안함

### 🎭 **작업 유형별 성능**
- **Assembly/Binary**: 41.84% (82/196)
- **Logs/Config**: 40.79% (31/76)
- **Source Code**: 35.33% (65/184)

### 💡 **주요 특징**
- ✅ **최고 속도**: 4.11초로 가장 빠름 ⚡
- ✅ **균형잡힌 성능**: Precision과 Recall의 최적 균형
- ✅ **현대 암호학 강점**: ECC(83%), DH(69%) 우수
- ✅ **가장 많은 탐지**: 473개 알고리즘 탐지 (다양성)
- ✅ **효율적 컨텍스트 처리**: RAG 추가해도 속도 저하 없음
- ✅ **멀티모달 우수**: 다양한 입력 형식 처리
- ✅ **겸손한 자신감**: 신뢰도 0.82로 적절
- ✅ **한국 알고리즘 상대적 우수**: 31.6% (여전히 낮지만)
- ❌ **RAG 약간 역효과**: -3.51% (자체 판단 선호)
- ❌ **SHA-2 취약**: 25%로 여전히 낮음
- ❌ **암호화 모드 취약**: GCM, CTR 0%

### 🎯 **권장 사용 사례**
- 실시간 분석이 필요한 환경 (최고 속도)
- 균형잡힌 탐지 필요 (Precision과 Recall 모두 중요)
- 현대 암호학 알고리즘 탐지 (ECC, DH)
- 다양한 파일 형식 처리
- 대규모 배치 처리 (속도와 정확도의 균형)

---

## 🔬 **심층 비교 분석**

### 1️⃣ **RAG 효과 비교**

| 모델 | RAG 효과 | 이유 |
|------|----------|------|
| **GPT-4o** | **+8.33%** ✅ | RLHF로 instruction-following 최적화, RAG를 "지시사항"으로 해석 |
| **Gemini-1.5** | **-3.51%** | 자체 판단과 외부 정보를 균형있게 결합, 맹목적 추종 안함 |
| **Llama 3 8B** | **-17.54%** ❌ | Foundation model로 instruction-following 약함, RAG가 혼란 야기 |

### 2️⃣ **속도 vs 정확도 트레이드오프**

```
정확도 (F1-Score)
    ↑
27% │           ● Gemini (4.11s)
    │
25% │      ● Llama (13.57s)
    │    ● GPT-4o (5.73s)
23% │
    │
    └─────────────────────────→ 속도
       빠름              느림
```

**Gemini-1.5가 최적**: 가장 빠르면서도 가장 정확함

### 3️⃣ **Precision vs Recall 트레이드오프**

```
Precision
    ↑
30% │  ● GPT-4o (보수적)
    │
28% │     ● Gemini (균형)
    │
26% │
    │
24% │
    │
22% │           ● Llama (공격적)
    │
    └─────────────────────────→ Recall
      15%    20%    25%    30%
```

- **GPT-4o**: 높은 Precision, 낮은 Recall (보수적)
- **Llama 3**: 낮은 Precision, 높은 Recall (공격적)
- **Gemini-1.5**: 균형잡힌 위치 (최적)

### 4️⃣ **알고리즘 카테고리별 강점 매트릭스**

| 알고리즘 카테고리 | GPT-4o | Llama 3 | Gemini-1.5 | 최강자 |
|------------------|--------|---------|------------|--------|
| **RSA** | 48.1% | 43.0% | 51.9% | Gemini 🥇 |
| **DSA** | 52.2% | **60.0%** | 53.1% | Llama 🥇 |
| **DH** | 65.7% | 50.0% | **68.8%** | Gemini 🥇 |
| **ECC** | 41.7% | 33.3% | **83.3%** | Gemini 🥇 |
| **AES** | 41.2% | **60.0%** | **60.0%** | Llama/Gemini 🥇 |
| **DES/3DES** | 37.5% | 25.0% | **55.6%** | Gemini 🥇 |
| **MD5** | **75.0%** | 100.0% | 71.4% | Llama 🥇 |
| **SHA-1** | 40.0% | 50.0% | **58.3%** | Gemini 🥇 |
| **SHA-2** | 16.7% | **40.0%** | 25.0% | Llama 🥇 |
| **RC4** | 50.0% | **100%** | 66.7% | Llama 🥇 |
| **ChaCha20** | 33.3% | **100%** | 33.3% | Llama 🥇 |
| **Korean Algo** | 16.2% 🔴 | 18.8% 🔴 | **31.6%** 🔴 | Gemini (여전히 낮음) |
| **GCM/CTR** | **0%** 🔴 | **0%** 🔴 | **0%** 🔴 | 모두 실패 |

**Gemini-1.5**: 12개 중 8개 카테고리에서 1위 🏆

### 5️⃣ **작업 유형별 특화도**

| 작업 유형 | GPT-4o | Llama 3 | Gemini-1.5 | 최적 모델 |
|-----------|--------|---------|------------|-----------|
| **Source Code** | 21.20% | 31.52% | **35.33%** | Gemini 🥇 |
| **Assembly/Binary** | 29.59% | **42.35%** | 41.84% | Llama 🥇 |
| **Logs/Config** | **44.74%** | **53.95%** | 40.79% | Llama 🥇 |

- **Llama 3**: 바이너리/로그 분석 특화 (낮은 수준 분석)
- **Gemini-1.5**: 소스 코드 분석 우수 (고수준 분석)
- **GPT-4o**: 구조화된 로그에서만 경쟁력

---

## 🎯 **종합 결론 및 권장사항**

### 🏆 **전체 순위**

#### **종합 성능** (F1-Score 기준)
1. 🥇 **Gemini-1.5**: 26.73% (속도와 정확도의 최적 균형)
2. 🥈 **Llama 3 8B**: 23.65% (바이너리/로그 분석 특화)
3. 🥉 **GPT-4o**: 23.11% (정밀도 중시)

#### **실용성** (속도 × 정확도)
1. 🥇 **Gemini-1.5**: 최고 속도 + 최고 정확도
2. 🥈 **GPT-4o**: 중간 속도 + 높은 정밀도
3. 🥉 **Llama 3 8B**: 느린 속도 (오픈소스 장점)

### 📌 **시나리오별 최적 모델**

#### **1. 실시간 위협 탐지 시스템**
→ **Gemini-1.5** ⚡
- 4.11초의 빠른 응답
- 균형잡힌 Precision/Recall
- 현대 암호학 (ECC, DH) 탐지 우수

#### **2. 정밀 보안 감사 (False Positive 최소화)**
→ **GPT-4o** 🎯
- 29.41% Precision (최고)
- RAG 활용 우수 (+8.33%)
- 구조화된 로그 분석 강점

#### **3. 바이너리/펌웨어 분석**
→ **Llama 3 8B** 🔍
- 42.35% Binary 분석 (최고)
- RAG 없이 독립 분석
- 오픈소스 (비용 효율)

#### **4. 넓은 초기 스크리닝**
→ **Llama 3 8B** 📡
- 25.05% Recall (최고)
- 공격적 탐지로 놓치는 것 최소화
- 이후 정밀 분석 필요

#### **5. 한국 표준 암호 탐지**
→ **Gemini-1.5** (그래도 31.6%로 낮음) 🇰🇷
- 모든 모델이 취약하지만 Gemini가 상대적으로 나음
- **추가 학습/파인튜닝 필요**

#### **6. 현대 암호학 (ECC, ChaCha20, SHA-3)**
→ **Gemini-1.5** 🆕
- ECC 83.3% (압도적)
- 최신 알고리즘 인식 우수

### ⚠️ **모든 모델의 치명적 약점**

#### **공통 실패 영역**
1. **암호화 모드**: GCM(0%), CTR(0%), CBC(낮음)
2. **한국 표준**: SEED, HIGHT, ARIA, LEA (16-31%)
3. **SHA-2**: 17-40% (현대 해시 표준인데도 낮음)

#### **개선 방안**
- 한국 표준 암호에 대한 파인튜닝 필요
- 암호화 모드 탐지를 위한 추가 학습 데이터
- SHA-2 패턴 인식 강화

---

## 💡 **핵심 인사이트**

### 1️⃣ **RAG의 역설**
- **GPT-4o**: RLHF로 RAG를 "지시"로 해석 → +8.33%
- **Llama 3**: Foundation model로 RAG가 혼란 → -17.54%
- **Gemini**: 자체 판단과 균형 → -3.51%

### 2️⃣ **속도와 정확도는 양립 가능**
- Gemini-1.5가 증명: 가장 빠르면서도 가장 정확함
- Llama가 느린 이유: 작은 모델 크기(8B) + 최적화 부족

### 3️⃣ **구형 알고리즘을 더 잘 탐지하는 역설**
- MD5(71-100%), RC4(50-100%) → 높은 정확도
- SHA-2(17-40%), ChaCha20(33-100%) → 낮은 정확도
- 이유: 학습 데이터에 구형 알고리즘이 더 많음

### 4️⃣ **한국 표준 암호는 "존재하지 않는" 수준**
- GPT-4o: 16.2%
- Llama 3: 18.8%
- Gemini-1.5: 31.6%
- **서구 중심 학습 데이터의 한계**

---

## 📊 **최종 추천 매트릭스**

| 요구사항 | 1순위 | 2순위 | 3순위 |
|---------|-------|-------|-------|
| **종합 성능** | Gemini-1.5 | Llama 3 | GPT-4o |
| **속도** | Gemini-1.5 ⚡ | GPT-4o | Llama 3 |
| **정밀도** | GPT-4o 🎯 | Gemini-1.5 | Llama 3 |
| **재현율** | Gemini-1.5 | Llama 3 📡 | GPT-4o |
| **RAG 활용** | GPT-4o ✅ | Gemini-1.5 | Llama 3 ❌ |
| **바이너리 분석** | Llama 3 🔍 | Gemini-1.5 | GPT-4o |
| **소스코드 분석** | Gemini-1.5 | Llama 3 | GPT-4o |
| **현대 암호학** | Gemini-1.5 🆕 | GPT-4o | Llama 3 |
| **비용 효율** | Llama 3 💰 | Gemini-1.5 | GPT-4o |
| **한국 표준** | Gemini-1.5 🇰🇷 | Llama 3 | GPT-4o |

---

**생성일**: 2025-11-05
**분석 대상**: GPT-4o, Llama 3 8B, Gemini-1.5
**테스트 규모**: 456개 테스트 × 3 모델 = 1,368개 평가
