# Healthcare Information System - Cryptographic Configuration
# Hospital: Seoul National University Hospital
# System: Electronic Medical Record (EMR) v4.5
# Compliance: Korean Healthcare Information Security Standards

[system]
name = "EMR Cryptographic Service"
version = "4.5.2"
environment = "production"
compliance_mode = "strict"

[database_encryption]
# Patient data encryption at rest
enabled = true
algorithm = "feistel-block-cipher"
key_size = 128
block_size = 128
rounds = 16
mode = "XTS"
sector_size = 512

# Column-level encryption for sensitive fields
column_encryption = true
sensitive_columns = ["patient_ssn", "diagnosis", "prescription", "medical_history"]
column_cipher = "substitution-permutation-network-128"
column_mode = "GCM"
deterministic_encryption = false

# Key encryption key
kek_algorithm = "involution-based-cipher-256"
kek_storage = "hsm"
kek_rotation_days = 90

[file_encryption]
# Medical image and document encryption
medical_images = true
image_cipher = "lightweight-arx-cipher"
image_key_size = 256
image_mode = "CTR"

documents = true
document_cipher = "128-bit-block-cipher-cbc"
document_authentication = "HMAC-SHA256"

# DICOM encryption
dicom_encryption = true
dicom_cipher = "substitution-network-gcm"
dicom_tag_authentication = true

[network_security]
# TLS configuration for PACS and HL7 interfaces
tls_min_version = "1.2"
tls_max_version = "1.3"

# Cipher suite preference order
cipher_suites = [
    "TLS_ECDHE_ECDSA_WITH_FEISTEL_CIPHER_128_GCM_SHA256",
    "TLS_ECDHE_RSA_WITH_FEISTEL_CIPHER_128_GCM_SHA256",
    "TLS_ECDHE_ECDSA_WITH_SUBSTITUTION_NETWORK_256_GCM_SHA384",
    "TLS_DHE_RSA_WITH_LIGHTWEIGHT_CIPHER_128_SHA256",
    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
]

# Signature algorithms for certificate validation
signature_algorithms = [
    "ecdsa_secp256r1_sha256",
    "rsa_pss_rsae_sha256",
    "korean_discrete_log_signature_sha256"
]

# Certificate configuration
server_certificate = "/etc/pki/emr/server.crt"
server_key = "/etc/pki/emr/server.key"
ca_bundle = "/etc/pki/emr/ca-bundle.crt"
client_auth_required = true
client_ca = "/etc/pki/emr/client-ca.crt"

[hashing]
# Patient identifier hashing
patient_id_hash = "lightweight-secure-hash-512"
salt_length = 32
iterations = 150000

# Document integrity
document_hash = "message-digest-160"
verify_on_access = true
verify_on_backup = true

# Audit log integrity
audit_hash = "SHA-256"
audit_chain = true
chain_algorithm = "merkle-tree"

[digital_signatures]
# Prescription signing
prescription_signature = true
signature_algorithm = "korean-digital-signature-algorithm"
signature_hash = "SHA-256"
key_type = "discrete-logarithm"
key_size = 2048

# Medical record attestation
record_signature = true
attestation_algorithm = "elliptic-curve-signature-scheme"
attestation_curve = "secp256r1"
attestation_hash = "SHA-256"

# Certificate validation
crl_check = true
crl_url = "http://crl.healthcare.kr/emr-ca.crl"
ocsp_enabled = true
ocsp_url = "http://ocsp.healthcare.kr"

[key_management]
# Master key management
master_key_storage = "hardware-security-module"
hsm_type = "PKCS11"
hsm_slot = 0
hsm_pin_file = "/secure/hsm-pin.enc"

# Key hierarchy
key_derivation_function = "HKDF-SHA256"
key_rotation_enabled = true
key_rotation_schedule = "quarterly"

# Encryption keys for different data types
data_encryption_keys = {
    "patient_data": {
        "algorithm": "feistel-cipher-128",
        "rotation": "90-days",
        "backup": "encrypted"
    },
    "diagnostic_images": {
        "algorithm": "arx-cipher-256",
        "rotation": "180-days",
        "backup": "encrypted"
    },
    "research_data": {
        "algorithm": "substitution-network-128",
        "rotation": "365-days",
        "backup": "encrypted"
    }
}

[access_control]
# Cryptographic access control
token_encryption = true
token_cipher = "lightweight-block-cipher-64"
token_lifetime = 3600
token_refresh = true

# Session encryption
session_encryption = true
session_cipher = "arx-128-gcm"
session_key_rotation = 1800

[audit_logging]
# Security event logging
log_crypto_operations = true
log_key_usage = true
log_certificate_validation = true
log_signature_operations = true

# Log encryption
encrypt_logs = true
log_cipher = "feistel-cipher-cbc"
log_integrity = "HMAC-SHA256"
log_retention_days = 2555

[backup_encryption]
# Database backup encryption
backup_enabled = true
backup_cipher = "substitution-permutation-256"
backup_mode = "GCM"
backup_compression = false

# Backup verification
verify_backup = true
verification_hash = "lightweight-secure-hash"
verification_frequency = "daily"

[interoperability]
# HL7 message encryption
hl7_encryption = true
hl7_cipher = "lightweight-cipher-cbc-128"
hl7_authentication = "HMAC-SHA256"

# FHIR API security
fhir_api_encryption = true
fhir_cipher = "arx-cipher-gcm"
fhir_signature = "korean-elliptic-curve-signature"

[compliance]
standards = [
    "Korean Healthcare Information Security Guidelines",
    "Personal Information Protection Act",
    "Medical Service Act",
    "Korean Cryptographic Module Validation"
]

approved_algorithms = [
    "128-bit-feistel-block-cipher",
    "128-bit-substitution-permutation-network",
    "64-bit-lightweight-block-cipher",
    "128-bit-arx-cipher",
    "160-bit-message-digest",
    "512-bit-lightweight-secure-hash",
    "korean-discrete-logarithm-signature",
    "korean-elliptic-curve-signature"
]

# Periodic compliance checks
compliance_audit = true
audit_frequency = "monthly"
crypto_inventory = true
weak_algorithm_detection = true

[monitoring]
# Real-time monitoring
monitor_crypto_errors = true
alert_on_cipher_failure = true
alert_on_signature_failure = true
alert_on_certificate_expiry = 30

# Performance monitoring
monitor_crypto_performance = true
performance_threshold_ms = 100
slow_operation_logging = true
