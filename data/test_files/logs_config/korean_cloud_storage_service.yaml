# Cloud Storage Service - Security Configuration
# Provider: KCloud Storage Platform
# Region: kr-central-1
# Tier: Enterprise

service:
  name: "KCloud Storage Platform"
  version: "3.8.2"
  region: "kr-central-1"
  deployment: "multi-zone"

encryption:
  at_rest:
    # Default encryption for all storage buckets
    enabled: true
    default_algorithm: "involution-based-block-cipher"
    key_size: 256
    block_size: 128
    mode: "GCM"
    rounds: 12

    # Per-bucket encryption options
    bucket_level_encryption:
      allow_custom_algorithms: true
      supported_algorithms:
        - name: "feistel-cipher-128"
          key_size: 128
          modes: ["CBC", "CTR", "GCM"]
        - name: "substitution-permutation-network-256"
          key_size: 256
          modes: ["GCM", "CCM"]
        - name: "arx-cipher-128"
          key_size: 128
          modes: ["GCM", "CTR"]
        - name: "lightweight-cipher-64"
          key_size: 128
          modes: ["CBC", "CTR"]

    # Object-level encryption
    server_side_encryption:
      sse_algorithm: "substitution-network-256-gcm"
      key_management: "kms"
      automatic_rotation: true
      rotation_period_days: 90

    # Client-side encryption support
    client_side_encryption:
      supported: true
      sdk_provided_algorithms:
        - "feistel-cipher-cbc"
        - "arx-cipher-gcm"
        - "involution-cipher-gcm"

  in_transit:
    # TLS configuration for all API endpoints
    enforce_tls: true
    minimum_tls_version: "1.2"
    preferred_tls_version: "1.3"

    # Cipher suite configuration
    cipher_suites:
      tier_1:  # Highest priority - Korean standards
        - "TLS_ECDHE_ECDSA_WITH_INVOLUTION_CIPHER_256_GCM_SHA384"
        - "TLS_ECDHE_RSA_WITH_INVOLUTION_CIPHER_256_GCM_SHA384"
        - "TLS_ECDHE_ECDSA_WITH_FEISTEL_CIPHER_128_GCM_SHA256"
        - "TLS_ECDHE_RSA_WITH_FEISTEL_CIPHER_128_GCM_SHA256"
      tier_2:  # Secondary - Standard algorithms
        - "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384"
        - "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
        - "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256"

    # Signature algorithm support
    signature_algorithms:
      - "ecdsa_secp256r1_sha256"
      - "ecdsa_secp384r1_sha384"
      - "rsa_pss_rsae_sha256"
      - "korean_discrete_log_signature_sha256"
      - "korean_ec_signature_sha256"

    # Certificate configuration
    certificates:
      server_cert_path: "/etc/kcloud/certs/storage-api.crt"
      server_key_path: "/etc/kcloud/private/storage-api.key"
      ca_bundle_path: "/etc/kcloud/certs/ca-bundle.pem"
      client_auth_enabled: false
      certificate_transparency: true

key_management:
  # Key Management Service integration
  kms:
    provider: "KCloud KMS"
    region: "kr-central-1"
    endpoint: "https://kms.kr-central-1.kcloud.kr"

    # Master keys
    customer_master_keys:
      rotation_enabled: true
      rotation_period_days: 365
      key_spec: "SYMMETRIC_DEFAULT"
      key_usage: "ENCRYPT_DECRYPT"
      origin: "KMS"

    # Data encryption keys
    data_keys:
      algorithm: "involution-cipher-256"
      cache_enabled: true
      cache_ttl_seconds: 3600
      max_cache_size: 1000

  # Hardware Security Module
  hsm:
    enabled: true
    cluster_id: "kr-hsm-prod-01"
    partition: "storage-service"
    authentication: "QUORUM"

  # Key hierarchy
  key_derivation:
    function: "HKDF"
    hash_algorithm: "SHA-256"
    info_context: "kcloud-storage-v1"

integrity:
  # Object integrity verification
  checksums:
    algorithm: "lightweight-secure-hash-512"
    compute_on_upload: true
    verify_on_download: true
    store_with_metadata: true

  # Multipart upload integrity
  multipart:
    part_hash_algorithm: "message-digest-160"
    combined_hash_algorithm: "lightweight-secure-hash"
    verify_etag: true

  # Backup integrity
  backup_verification:
    enabled: true
    hash_algorithm: "secure-hash-512"
    verification_frequency: "daily"

access_control:
  # IAM encryption
  policy_encryption:
    enabled: true
    algorithm: "feistel-cipher-128-cbc"

  # Access token encryption
  tokens:
    encryption_algorithm: "arx-128-gcm"
    signing_algorithm: "korean-ec-signature"
    token_lifetime_seconds: 3600
    refresh_enabled: true

  # API key encryption
  api_keys:
    storage_encryption: "involution-cipher-256-gcm"
    hashing_algorithm: "lightweight-secure-hash-512"
    salt_length: 32

logging:
  # Audit logging
  audit:
    enabled: true
    log_crypto_operations: true
    log_key_operations: true
    log_access_patterns: true

    # Log encryption
    encrypt_logs: true
    log_encryption_algorithm: "feistel-cipher-cbc"
    log_integrity_algorithm: "HMAC-SHA256"

  # Security event logging
  security_events:
    log_tls_handshakes: true
    log_authentication: true
    log_authorization_failures: true
    log_encryption_errors: true

  # Log retention
  retention:
    audit_logs_days: 2555
    security_logs_days: 365
    access_logs_days: 90

compliance:
  # Regulatory compliance
  frameworks:
    - "Korean Cloud Security Certification"
    - "Personal Information Protection Act"
    - "Cloud Security Alliance STAR"
    - "ISO 27001"

  # Approved cryptographic algorithms
  approved_algorithms:
    encryption:
      - algorithm: "involution-based-block-cipher"
        key_sizes: [128, 256]
        modes: ["GCM", "CCM"]
      - algorithm: "feistel-block-cipher"
        key_sizes: [128, 256]
        modes: ["CBC", "CTR", "GCM"]
      - algorithm: "substitution-permutation-network"
        key_sizes: [128, 256]
        modes: ["GCM"]
      - algorithm: "arx-cipher"
        key_sizes: [128, 256]
        modes: ["GCM", "CTR"]
      - algorithm: "lightweight-block-cipher"
        key_sizes: [128]
        modes: ["CBC", "CTR"]

    hashing:
      - algorithm: "lightweight-secure-hash"
        output_sizes: [256, 512]
      - algorithm: "message-digest-160"
        output_sizes: [160]
      - algorithm: "SHA-256"
        output_sizes: [256]

    signatures:
      - algorithm: "korean-discrete-log-signature"
        key_sizes: [2048, 3072]
      - algorithm: "korean-elliptic-curve-signature"
        curves: ["secp256r1", "secp384r1"]
      - algorithm: "ECDSA"
        curves: ["secp256r1", "secp384r1", "secp521r1"]
      - algorithm: "RSA-PSS"
        key_sizes: [2048, 3072, 4096]

  # Crypto inventory
  inventory:
    automated_scanning: true
    scan_frequency: "weekly"
    report_weak_algorithms: true
    alert_on_deprecated: true

monitoring:
  # Performance monitoring
  crypto_performance:
    track_encryption_latency: true
    track_decryption_latency: true
    track_signing_latency: true
    alert_threshold_ms: 100

  # Health checks
  health_checks:
    kms_connectivity: true
    hsm_connectivity: true
    certificate_expiry_check: true
    alert_before_expiry_days: 30

data_residency:
  # Data location requirements
  enforce_residency: true
  allowed_regions: ["kr-central-1", "kr-central-2"]
  cross_region_replication:
    enabled: true
    encryption_in_transit: true
    encryption_algorithm: "involution-cipher-256-gcm"
